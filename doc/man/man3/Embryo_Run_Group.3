.TH "Program Run Functions" 3 "19 May 2008" "Embryo" \" -*- nroff -*-
.ad l
.nh
.SH NAME
Program Run Functions \- Functions that are involved in actually running functions in an Embryo program.  

.PP
.SS "Functions"

.in +1c
.ti -1c
.RI "EAPI int \fBembryo_program_recursion_get\fP (Embryo_Program *ep)"
.br
.RI "\fIReturns the number of virtual machines are running for the given program. \fP"
.ti -1c
.RI "EAPI int \fBembryo_program_run\fP (Embryo_Program *ep, Embryo_Function fn)"
.br
.RI "\fIRuns the given function of the given Embryo program in the current virtual machine. \fP"
.ti -1c
.RI "EAPI Embryo_Cell \fBembryo_program_return_value_get\fP (Embryo_Program *ep)"
.br
.RI "\fIRetreives the return value of the last called function of the given program. \fP"
.ti -1c
.RI "EAPI void \fBembryo_program_max_cycle_run_set\fP (Embryo_Program *ep, int max)"
.br
.RI "\fISets the maximum number of abstract machine cycles any given program run can execute before being put to sleep and returning. \fP"
.ti -1c
.RI "EAPI int \fBembryo_program_max_cycle_run_get\fP (Embryo_Program *ep)"
.br
.RI "\fIRetreives the maximum number of abstract machine cycles a program is allowed to run. \fP"
.in -1c
.SH "Detailed Description"
.PP 
Functions that are involved in actually running functions in an Embryo program. 
.PP
.SH "Function Documentation"
.PP 
.SS "EAPI int embryo_program_max_cycle_run_get (Embryo_Program * ep)"
.PP
Retreives the maximum number of abstract machine cycles a program is allowed to run. 
.PP
\fBParameters:\fP
.RS 4
\fIep\fP The given program. 
.RE
.PP
\fBReturns:\fP
.RS 4
The number of cycles a run cycle is allowed to run for this program.
.RE
.PP
This returns the value set by \fBembryo_program_max_cycle_run_set()\fP. See \fBembryo_program_max_cycle_run_set()\fP for more information. 
.SS "EAPI void embryo_program_max_cycle_run_set (Embryo_Program * ep, int max)"
.PP
Sets the maximum number of abstract machine cycles any given program run can execute before being put to sleep and returning. 
.PP
\fBParameters:\fP
.RS 4
\fIep\fP The given program. 
.br
\fImax\fP The number of machine cycles as a limit.
.RE
.PP
This sets the maximum number of abstract machine (virtual machine) instructions that a single run of an embryo function (even if its main) can use before embryo \fBembryo_program_run()\fP reutrns with the value EMBRYO_PROGRAM_TOOLONG. If the function fully executes within this number of cycles, \fBembryo_program_run()\fP will return as normal with either EMBRYO_PROGRAM_OK, EMBRYO_PROGRAM_FAIL or EMBRYO_PROGRAM_SLEEP. If the run exceeds this instruction count, then EMBRYO_PROGRAM_TOOLONG will be returned indicating the program exceeded its run count. If the app wishes to continue running this anyway - it is free to process its own events or whatever it wants and continue the function by calling embryo_program_run(program, EMBRYO_FUNCTION_CONT); which will start the run again until the instruction count is reached. This can keep being done to allow the calling program to still be able to control things outside the embryo function being called. If the maximum run cycle count is 0 then the program is allowed to run forever only returning when it is done.
.PP
It is important to note that abstract machine cycles are NOT the same as the host machine cpu cycles. They are not fixed in runtime per cycle, so this is more of a helper tool than a way to HARD-FORCE a script to only run for a specific period of time. If the cycle count is set to something low like 5000 or 1000, then every 1000 (or 5000) cycles control will be returned to the calling process where it can check a timer to see if a physical runtime limit has been elapsed and then abort runing further assuming a 'runaway script' or keep continuing the script run. This limits resolution to only that many cycles which do not take a determined amount of time to execute, as this varies from cpu to cpu and also depends on how loaded the system is. Making the max cycle run too low will impact performance requiring the abstract machine to do setup and teardown cycles too often comapred to cycles actually executed.
.PP
Also note it does NOT include nested abstract machines. IF this abstract machine run calls embryo script that calls a native function that in turn calls more embryo script, then the 2nd (and so on) levels are not included in this run count. They can set their own max instruction count values separately.
.PP
The default max cycle run value is 0 in any program until set with this function. 
.SS "EAPI int embryo_program_recursion_get (Embryo_Program * ep)"
.PP
Returns the number of virtual machines are running for the given program. 
.PP
\fBParameters:\fP
.RS 4
\fIep\fP The given program. 
.RE
.PP
\fBReturns:\fP
.RS 4
The number of virtual machines running. 
.RE
.PP

.SS "EAPI Embryo_Cell embryo_program_return_value_get (Embryo_Program * ep)"
.PP
Retreives the return value of the last called function of the given program. 
.PP
\fBParameters:\fP
.RS 4
\fIep\fP The given program. 
.RE
.PP
\fBReturns:\fP
.RS 4
An Embryo_Cell representing the return value of the function that was last called. 
.RE
.PP

.SS "EAPI int embryo_program_run (Embryo_Program * ep, Embryo_Function fn)"
.PP
Runs the given function of the given Embryo program in the current virtual machine. 
.PP
The parameter \fCfn\fP can be found using \fBembryo_program_function_find\fP.
.PP
\fBNote:\fP
.RS 4
For Embryo to be able to run a function, it must have been declared \fCpublic\fP in the Small source code.
.RE
.PP
\fBParameters:\fP
.RS 4
\fIep\fP The given program. 
.br
\fIfn\fP The given function. Normally 'main', in which case the constant \fCEMBRYO_FUNCTION_MAIN\fP can be used. 
.RE
.PP
\fBReturns:\fP
.RS 4
\fCEMBRYO_PROGRAM_OK\fP on success. \fCEMBRYO_PROGRAM_SLEEP\fP if the program is halted by the Small \fCsleep\fP call. \fCEMBRYO_PROGRAM_FAIL\fP if there is an error. \fCEMBRYO_PROGRAM_TOOLONG\fP if the program executes for longer than it is allowed to in abstract machine instruction count. 
.RE
.PP

.PP
References EMBRYO_CELL_NONE, embryo_data_address_get(), embryo_data_heap_push(), embryo_data_string_set(), EMBRYO_ERROR_BOUNDS, EMBRYO_ERROR_DIVIDE, EMBRYO_ERROR_HEAPLOW, EMBRYO_ERROR_INDEX, EMBRYO_ERROR_INIT, EMBRYO_ERROR_INVINSTR, EMBRYO_ERROR_MEMACCESS, EMBRYO_ERROR_SLEEP, EMBRYO_FUNCTION_CONT, EMBRYO_FUNCTION_MAIN, EMBRYO_PROGRAM_FAIL, EMBRYO_PROGRAM_OK, and EMBRYO_PROGRAM_SLEEP.
